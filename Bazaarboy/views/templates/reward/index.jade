extends ../layout

block title
    | Rewards Dashboard

append head
    link(rel="stylesheet", href="{{ STATIC_URL }}pikaday/pikaday.css")

block sidebar
    +sidebarItem('ss-newspaper')(href="{% url 'index' %}")
        | Events
    +sidebarItem('ss-database')(href="{% url 'list:index' %}")
        | Lists
    +sidebarItem('ss-tag')(href="{% url 'reward:index' %}")(class="selected")
        | Gifts
    +sidebarItem('ss-share')(href="{% url 'user:settings' %}")
        | Settings

block header
    div.header-title.large-9.medium-10.columns.small-centered
        div.row.clearfix
            div.icon.left
                span.ss-file
            div.text.left
                | Gift Management |
                span.sub &nbsp;All Gifts

block content
    div#wrapper-reward-dashboard.large-9.medium-10.columns.small-centered
        {% if rewards.count == 0 and reward_items.count == 0 %}
        div.empty-state-container
            div.row
                div.medium-5.columns
                    &nbsp;
                div.medium-7.columns.end.empty-state-content
                    div.text YOU HAVEN'T MADE A GIFT YET
                    hr
                    div.subtext Create your first gift now!
                    div.row
                        div.large-5.medium-7.small-9
                            a.new-reward-btn(href="{% url 'reward:new' %}")
                                div.secondary-btn.btn.full-btn
                                    | <span class="plus">+</span> Add New Gift
        {% endif %}
        div#reward-dashboard.small-12.columns
            div.row.new-reward-container(class="{% if rewards.count == 0 and reward_items.count == 0 %}hide{% endif %}")
                div.medium-4.columns.new-reward
                    a.new-reward-btn.primary-btn(href="{% url 'reward:new' %}") + New Gift
            div.row
                {% if reward_items.count > 0 %}
                div.small-12.columns.rewards
                    div.headline Current Gifts
                    hr
                    {% for reward_item in reward_items %}
                    {% if reward_item.quantity > 0 %}
                    div
                        div.row.reward(data-id="{{ reward_item.id }}")
                            div.small-5.columns.reward-name
                                | {{ reward_item.reward.name|truncatechars:30 }}
                                span &nbsp;(
                                span.quantity {{ reward_item.quantity }}
                                span &nbsp;Left)
                            div.small-3.columns.text-right.reward-members
                                | Expires - {{ reward_item.expiration_time|date:"m/d/Y" }}
                            div.small-2.columns.text-right.reward-action
                                a(href="{{ reward_item.reward.attachment.source.url }}", target="_blank") View Gift
                            div.small-2.columns.text-right.reward-action
                                a.send-gift-item(href="javascript:;", data-id="{{ reward_item.id }}", data-quantity="{{ reward_item.quantity }}", data-name="{{ reward_item.reward.name }}") Send Gift
                    {% endif %}
                    {% endfor %}
                {% endif %}
                {% if rewards.count > 0 %}
                div.small-12.columns.rewards
                    div.headline Gift Templates
                    hr
                    {% for reward in rewards %}
                    div
                        div.row.reward
                            div.small-6.columns.reward-name
                                | {{ reward.name|truncatechars:30 }}
                            div.small-3.columns.text-right.reward-action
                                a(class="{% if subscription %}send-reward-btn{% else %}create-subscription{% endif %}", href="javascript:;", data-id="{{ reward.id }}", data-name="{{ reward.name }}") Send Gift
                            div.small-3.columns.text-right.reward-action
                                a.manage-reward(href="{% url 'reward:manage' reward.id %}") Manage/Redeem
                    {% endfor %}
                {% endif %}
    
    div#send-reward-modal.reveal-modal.medium(data-reveal)
        div.organizer-model.hide
            div.row.organizer
                div.medium-3.columns.organizer-image &nbsp;
                div.medium-6.columns.organizer-name &nbsp;
                div.medium-3.columns.organizer-submit
                    a.add-reward-submit.secondary-btn-inverse.full-btn(href="javascript:;") Add Gifts
        div.row
            div.small-12.columns
                div.headline Send&nbsp;'
                    span.reward-name &nbsp;
                    |'
                br
                div.send-description Send a gift via email.Send gifts to other organizations so they can distribute them to their audience. If you want to send gifts to your own audience, use the 'Add to My Profile' button.
                hr
        div.row
            div.small-12.columns
                input(type="hidden", name="reward_id", value="")
                div.row
                    div.small-12.medium-6.columns
                        label Quantity
                        input(type="text", name="quantity", placeholder="How Many Gifts?")
                    div.small-12.medium-6.columns
                        label Expiration Date
                        input(type="text", name="expiration", placeholder="Gift Expiration (MM/DD/YYYY)")
                hr
                div.row.send-actions
                    div.small-12.medium-4.columns
                        a.add-reward-submit.primary-btn-inverse.full-btn(href="javascript:;", data-profile="{{ profile.id }}") Add to My Profile
                    div.small-12.medium-4.columns
                        a.add-reward-email.primary-btn-inverse.full-btn(href="javascript:;") Send Via Email
                    div.small-12.medium-4.columns
                        a.add-reward-profile.primary-btn-inverse.full-btn(href="javascript:;") Search Accounts
                    div.small-12.columns.profile-search.hide
                        input(type="text", name="profile_search", placeholder="Search Account Name")
                    div.small-12.columns.email-send.hide
                        div.row
                            div.small-12.medium-8.columns
                                input(type="text", name="email_send", placeholder="Organization's Email")
                            div.small-12.medium-4.columns
                                a.send-via-email.primary-btn.full-btn(href="javascript:;") Send Gifts
        form.add-organizer-form(name="add-organizer")

    div#distribute-reward-modal.reveal-modal.medium(data-reveal)
        div.row
            div.small-12.columns
                div.headline Send&nbsp;'
                    span.reward-name &nbsp;
                    |'
                br
                div.send-description Send a gift via email.
                hr
        div.row
            div.small-12.columns
                input(type="hidden", name="reward_item_id", value="")
                div.row.send-actions
                    div.small-12.columns.email-send
                        div.row
                            div.small-12.medium-8.columns
                                input(type="text", name="email_distribute", placeholder="Reciever Email")
                            div.small-12.medium-4.columns
                                a.send-gift-btn.primary-btn.full-btn(href="javascript:;") Send Gift

    div#add-subscription-modal.reveal-modal.small(data-reveal)
        div.subscription-model.row
            div.small-12.columns
                div.row
                    div.small-12.columns
                        div.headline Create Subscription
                    hr
                div.row
                    div.small-12.columns.description
                        | Before sending a gift, you must subscribe to a Bazaarboy Gifts account. This account will be charged $1 for every gift that is claimed. A 'Claim' is when the user enters thier information, and an MMS with the attached gift is sent (shown below).
                        img(src="{{ STATIC_URL }}images/claim.png")
                        | By subscribing, you are agreeing to this payment. You will get 10 FREE gift credits after your subscription is complete.
                div.row
                    div.small-12.columns
                        div.row
                            div.small-12.medium-8.columns
                                a.create-subscription.primary-btn-inverse.full-btn(href="javascript:;") Subscribe
                            div.small-12.medium-4.columns
                                a.cancel-subscription.btn.full-btn(href="javascript:;") Cancel
                    


append script
    script.
        var profileId = {{ profile.id }};
        var publishableKey = '{{ publishable_key }}';
    script(type="text/javascript", src="{{ STATIC_URL }}pikaday/pikaday.js")
    script(type="text/javascript", src="{{ STATIC_URL }}pikaday/pikaday.jquery.js")
    script(type="text/javascript", src="{{ STATIC_URL }}debounce/jquery.debounce.js")
    script(type="text/javascript", src="https://checkout.stripe.com/v2/checkout.js")
    script(type="text/javascript", src="https://js.stripe.com/v2/")
    script(src="{{ STATIC_URL }}js/reward/index.js")